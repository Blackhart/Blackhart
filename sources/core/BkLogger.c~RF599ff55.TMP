#include <stdio.h>

#include "core\BkLogger.h"
#include "pil\BkFileSystem.h"
#include "core\BkError.h"

// ~~~~~ Dcl(PROTECTED) ~~~~~

extern BkResult	LgInitialize(void);
extern BkResult	LgUninitialize(void);

// ~~~~~ Dcl(PRIVATE) ~~~~~

static BkFlux*	__BkGlobalLogFile = NULL;

// ~~~~~ Def(ALL) ~~~~~

BkResult	LgInitialize(void)
{
	BkResult lResult = BkOpenFlux(&__BkGlobalLogFile, "Log.txt", "w");
	FAILED_ASSERT(lResult);
	return lResult;
}

BkResult	LgUninitialize(void)
{
	BkResult lResult = BkCloseFlux(&__BkGlobalLogFile);
	FAILED_ASSERT(lResult);
	return lResult;
}

BkResult	BkLog_arglist(char const* const pFormat, ...)
{
	va_list		lArgList; // 4 bytes
	BkResult	lResult = BK_SUCCESS;

	va_start(lArgList, pFormat);

	lResult = BkWriteToFlux_valist(__BkGlobalLogFile, pFormat, lArgList);

	va_end(lArgList);

	return lResult;
}

BkResult	BkLog_valist(char const* const pFormat, va_list const ArgList)
{
	return BkWriteToFlux_valist(__BkGlobalLogFile, pFormat, lArgList);
}